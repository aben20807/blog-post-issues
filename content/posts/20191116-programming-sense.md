+++
title = "Programming Sense (1)"
date = "2019-11-16T08:53:13+08:00"
url = "/posts/20191116-programming-sense"
description = ""
image = "https://images.unsplash.com/photo-1539392156992-268f1e62f111?ixlib=rb-1.2.1&auto=format&fit=crop&w=2689&q=80"
credit = "https://unsplash.com/photos/hHdKh1Gr9gY"
thumbnail = ""
comments = true
categories = ["ç¨‹å¼è¨­è¨ˆ"]
tags = ["programming sense", "å°æŠ€å·§", "coding style", "c", "å¯è®€æ€§"]
toc = true
draft = false
+++
<!-- https://drive.google.com/uc?export=view&id= -->
ä¸»è¦æ˜¯æˆ‘è‡ªå·±ç·¨å¯«é‚Šå­¸æ…¢æ…¢ç´¯ç©çš„ï¼ŒèªªçœŸçš„ä¹Ÿæ‰¾ä¸å¤ªåˆ°ç›¸é—œçš„è³‡æºï¼Œè¦æœå°‹ä¹Ÿä¸çŸ¥é“ä¸‹ä»€éº¼é—œéµå­—ï¼Œå•åˆ¥äººå…¶å¯¦ä¹Ÿå¾ˆé›£åœ¨ä¸€æ™‚åŠåˆ»è£¡è§£é‡‹æ¸…æ¥šï¼Œæ‰€ä»¥å°±æ‹¿ä¾†ç™¼ä¸€ç¯‡å§ OuO

<!--more-->

# å‰è¨€

æœŸä¸­åŠ è³‡æ ¼è€ƒçš„çˆ†ç‚¸ç¦®æ‹œçµ‚æ–¼çµæŸï¼Œå…¶å¯¦æ¯”æˆ‘æƒ³å¾—é‚„è¦å®¹æ˜“ï¼Œé›–ç„¶æˆ‘éƒ½å¾ˆæ²’æŠŠæ¡ï¼Œå› ç‚ºæˆ‘å¹¾ä¹ä¸ç‹‚å¯«è€ƒå¤é¡Œï¼Œè€Œæ˜¯ä»¥è§€å¿µå–å‹ï¼Œæœ‰æ²’æœ‰å–åˆ°å°±ä¸ç¢ºå®šäº†ã€‚

å¯«ç¨‹å¼å¾ˆç°¡å–®ï¼Œæ‹¿ä¾†è§£æ±ºå•é¡Œå°±æœ‰äº›é›£åº¦ï¼Œæœ€é›£çš„æ˜¯ç”¨å„ªé›…æ˜“æ‡‚ä¸”åš´è¬¹çš„ç¨‹å¼ç¢¼ä¾†è§£æ±ºå•é¡Œï¼Œå¯«å¾—å¥½çµ•å°é é å¥½éå¯«å¾—å¿«ã€‚

é—œæ–¼é€™å€‹ä¸»é¡Œï¼Œå…¶å¯¦å¾ˆæ—©å°±æ‰“ç®—å¯«äº†ï¼Œåªæ˜¯ä¸€ç›´æ“±ç½®é€£æ¶æ§‹éƒ½æ²’å‡ºä¾†ï¼Œç›´åˆ°æœ€è¿‘æœ‰å¹«åŒå­¸çœ‹ä¸€ä¸‹ç¨‹å¼ç¢¼ï¼Œæ‰€ä»¥è¦ºå¾—é€™å€‹è§€å¿µé‚„æ˜¯é —ç‚ºé‡è¦ï¼Œæ‰€ä»¥æ•´ç†ä¸€ä¸‹ç™¼å€‹æ–‡ï¼Œä¸»è¦ä¹Ÿå¸Œæœ›å¯ä»¥å¹«åŠ©æ¯”è¼ƒæ²’ç¶“é©—çš„äººï¼Œä½†ä¹Ÿä¸é™æ–¼æ­¤ï¼Œæˆ‘ç›¸ä¿¡ä¹Ÿæœƒæœ‰ç•¢æ¥­æ–¼è³‡è¨Šå·¥ç¨‹ç›¸é—œç§‘ç³»è€Œæ²’æœ‰é€™äº›è§€å¿µã€‚


ç•¶ç„¶åœ¨æ•´å€‹ç¨‹å¼ç•Œæˆ‘ä¹Ÿä¸æ˜¯è€æ‰‹ï¼Œå¹¾ä¹æ²’åœ¨é–‹æºè²¢ç»ï¼Œæ›´æ²’åƒèˆ‡éæ¥­ç•Œï¼Œæ‰€ä»¥å¾ˆå¤šçš„æ¦‚å¿µæ˜¯æˆ‘åœ¨å¤§å­¸æ™‚æœŸæ…¢æ…¢ç´¯ç©èµ·ä¾†çš„ï¼Œä¸»è¦ä¾†æºå°±æ˜¯ä¸€äº›é–‹æºçš„å°ˆæ¡ˆé‚„æœ‰è‡ªèº«çš„ç¶“é©—ï¼Œä¸èƒ½èªªæ¶µè“‹å¾—å¾ˆå…¨é¢ï¼Œä¹Ÿä¸æ˜¯èªªæˆ‘é€™å¥—æœ€æ£’äº†å¤§å®¶çœ‹äº†ä¹‹å¾Œä¸€å®šè¦ç…§é€™äº›è¦å‰‡ï¼Œé€™ç¯‡å¾ä¾†å°±ä¸æ˜¯è¦å‰‡ï¼Œè€Œæ˜¯æˆ‘åœ¨å¯«äº†å¹¾å¹´ç¨‹å¼å¾Œæ•´ç†å‡ºä¾†è®“è‡ªå·±é–‹ç™¼æ›´ç‚ºæµæš¢çš„ä¸€äº›æƒ³æ³•ï¼Œå¸Œæœ›å¤§å®¶èƒ½å¤ ä¾†äº’ç›¸è¨è«–çµ¦èˆ‡æ„è¦‹ã€‚


æ¶æ§‹æœƒä»¥ä¸åŒçš„ä¸»é¡Œç•¶ä½œæ¢è¨ï¼Œé›–ç„¶å…¨éƒ¨éƒ½æ˜¯åœ¨è¬› programming senseï¼Œå…§å®¹å› ç‚ºç›¸ç•¶å»£æ³›ï¼Œåˆ‡æˆä¸åŒæ–‡ç« åˆæœƒè®“æŸäº›éƒ¨åˆ†é›¶ç¢åŒ–ï¼Œæ‰€ä»¥è«‹å–„ç”¨æ¨™é¡Œè·Ÿå³æ–¹çš„ç›®éŒ„ä¾†å¹«åŠ©é–±è®€ã€‚é †åºä»¥ "å·¥å…·"ï¼Œ"coding style"ï¼Œ"ç¿’æ…£é¤Šæˆ"ï¼Œ"æŠ½åƒåŒ–"ï¼Œ"å¯«ç¨‹å¼çš„éç¨‹"ï¼Œ"é™¤éŒ¯"ã€‚ä¸¦ä¸»è¦ä»¥ C èªè¨€ç•¶ä½œè¬›è§£ç¯„ä¾‹ã€‚

é›–ç„¶é›œä½†æ˜¯è«‹è¨˜å¾—ä¸€å€‹ä¸­å¿ƒæ€æƒ³ï¼š

> ç”¨ç¨‹å¼ç¢¼ä¾†æºé€š (Communication Through Code)

# å·¥å…·

ã€Œå·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€ã€Šè«–èªÂ·è¡›éˆå…¬ã€‹ å–„ç”¨å·¥å…·çœŸçš„é —ç‚ºé‡è¦ï¼Œä½¿ç”¨å¾—ç•¶å¯ä»¥å¤§é‡æ¸›å°‘é‡è¤‡æ€§çš„å‹•ä½œï¼Œå¦‚æœæ˜¯å¯«ä¸€èˆ¬çš„å°ç¨‹å¼çš„è©±æˆ‘æœƒå»ºè­°å¯ä»¥ç©çœ‹çœ‹ [VIM](https://en.wikipedia.org/wiki/Vim_(text_editor)) è¨­å®šå¯ä»¥åƒè€ƒ[æˆ‘çš„è¨­å®š](https://github.com/aben20807/aben20807.vim)æˆ–ç›´æ¥å•æˆ‘ï¼Œå¯ä»¥å¤§é‡æ¸›å°‘æ‰‹éƒ¨çš„è² æ“”ã€‚å¤§å‹ä¸€é»çš„æˆ‘æœƒæ¨è–¦ [VSCode](https://code.visualstudio.com/)ï¼Œå› ç‚ºå…§å®¹æœƒåå¤šæ‰€ä»¥æˆ‘å°±ç”¨ä¸€å€‹å‰¯æ¨™é¡Œä¾†èªªæ˜äº†ã€‚

![google-vi... ](https://drive.google.com/open?id=1kYWGLrrnkeQaVo2OwbMZQddDu6iIn-do) [^7]

## VSCode

VSCode å…¶å¯¦ä¸å¤ªåƒä¸€èˆ¬çš„ IDEï¼Œå®ƒæ›´åƒä¸€å€‹å–®ç´”çš„æ–‡å­—ç·¨è¼¯å™¨ï¼Œåªæ˜¯æœ‰ç›¸ç•¶å¤šå¥½ç”¨çš„å¤–æ›åŠŸèƒ½ï¼ŒåŸºæœ¬çš„åŒ…å«äº†å°å„ç¨®èªè¨€çš„ç¨‹å¼ç¢¼çš„é—œéµå­— highlightã€æª”æ¡ˆæ¶æ§‹æ¨¹ã€æœå°‹å–ä»£åŠŸèƒ½ã€ç·¨ç¢¼è½‰æ›ã€coding style è‡ªå‹•é‡æ–°æ’ç‰ˆã€‚ä»¥ä¸‹é™„ä¸Šä¸€äº›æˆ‘ç›®å‰æœå½¹ä¸­çš„å¤–æ›åŠŸèƒ½ï¼Œä½¿ç”¨æ–¹æ³•å°±è«‹å„ä½è‡ªå·±å‰å¾€æŸ¥çœ‹äº†ï¼š

+ `alefragnani.bookmarks` [ğŸ”—](https://marketplace.visualstudio.com/items?itemName=alefragnani.Bookmarks)ï¼š å¯ä»¥åœ¨æƒ³è¦æ¨™è¨˜çš„ç¨‹å¼ç¢¼ä¸ŠåŠ å…¥æ›¸ç±¤ï¼Œé€™å€‹åœ¨ç€è¦½å¤§å‹å°ˆæ¡ˆéœ€è¦è·³ä¾†è·³å» trace ç¨‹å¼ç¢¼ä¸‹å¯ä»¥å¹«å¾ˆå¤§çš„å¿™ï¼Œè‡³å°‘ä¸ç”¨å†è¨˜æ˜¯ç¬¬å¹¾è¡Œäº†ã€‚
+ `coenraads.bracket-pair-colorizer` [ğŸ”—](https://marketplace.visualstudio.com/items?itemName=CoenraadS.bracket-pair-colorizer)ï¼šé€£çµå°æ‡‰çš„æ‹¬è™Ÿï¼Œé€™åœ¨æ‹¬è™Ÿä¸€å †çš„èªè¨€ (C, C++, Java, Lisp) ç›¸ç•¶æœ‰å¹«åŠ©ï¼Œå¯ä»¥ä¸€çœ¼å°±çœ‹å‡ºåœ¨å“ªå€‹æœ‰æ•ˆç¯„åœ (scope)ã€‚
+ `streetsidesoftware.code-spell-checker` [ğŸ”—](https://marketplace.visualstudio.com/items?itemName=streetsidesoftware.code-spell-checker)ï¼šå¹«å¿™æª¢æŸ¥è‹±æ–‡æ‹¼å­—ã€‚
+ `tabnine.tabnine-vscode` [ğŸ”—](https://marketplace.visualstudio.com/items?itemName=TabNine.tabnine-vscode)ï¼šç¨‹å¼ç¢¼è£œå…¨å»ºè­°ã€‚
+ `gruntfuggly.todo-tree` [ğŸ”—](https://marketplace.visualstudio.com/items?itemName=Gruntfuggly.todo-tree)ï¼šæ”¶é›†è¨»è§£ä¸­æœ‰ `TODO` æ¨™ç±¤çš„åœ°æ–¹ã€‚
+ `donjayamanne.githistory` [ğŸ”—](https://marketplace.visualstudio.com/items?itemName=donjayamanne.githistory)ï¼šGit ç³»åˆ—ã€‚
+ `eamodio.gitlens` [ğŸ”—](https://marketplace.visualstudio.com/items?itemName=eamodio.gitlens)ï¼šGit ç³»åˆ—ã€‚
+ `zhuangtongfa.material-theme` [ğŸ”—](https://marketplace.visualstudio.com/items?itemName=zhuangtongfa.Material-theme)ï¼šè€çœ‹ä¸»é¡Œã€‚
+ `vscode-icons-team.vscode-icons` [ğŸ”—](https://marketplace.visualstudio.com/items?itemName=vscode-icons-team.vscode-icons)ï¼šç¾ç¾çš„æª”æ¡ˆåœ–ç¤ºã€‚

![google-åç¨±æ‹¿å»æœå°‹å³å¯](https://drive.google.com/open?id=1YrpZ2ktFpMxR3Y7MZM0zBrt4DtRFNmga)

## Shell

å¾ˆå¤šæŒ‡ä»¤éƒ½æ˜¯å¯ä»¥å¹«åŠ©æ‡¶æƒ°çš„äººï¼Œç›®å‰æˆ‘é‚„æ²’æœ‰é‡éæˆ‘æƒ³è¦ä½†æ˜¯æ²’æœ‰çš„æŒ‡ä»¤ã€‚

### é‡æ–°å°å‘ (Redirection)

å¯«ç¨‹å¼æ™‚æœƒå¸¸ä½¿ç”¨é‡æ–°å°å‘ (Redirection) çš„æ–¹å¼ä¾†æ¸›å°‘æ¨™æº–è¼¸å…¥ (stdin) çš„æ¬¡æ•¸ï¼Œç”¨æ³•ä¹Ÿç›¸ç•¶ç›´è§€ï¼Œåªéœ€è¦å…ˆå°‡æ¸¬è©¦è¼¸å…¥å…ˆæ‰“åœ¨ä¸€ä»½æ–‡æª” (ä¾‹å¦‚ï¼šinput.txt) ä¸­ï¼Œå†ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤åŸ·è¡Œç¨‹å¼å³å¯ã€‚

```bash
$ ./queue < input.txt
```

è‹¥è¦æŠŠæ¨™æº–è¼¸å‡º (stdout) å­˜åˆ°å¦ä¸€ä»½æ–‡ä»¶æ™‚å‘¢ï¼Œç•¶ç„¶ä¹Ÿæ˜¯ä½¿ç”¨é‡æ–°å°å‘ã€‚é€™é©åˆåœ¨è¼¸å‡ºå¾ˆå¤šæ™‚æˆ–æ˜¯éœ€è¦æœå°‹çµæœæ™‚ä½¿ç”¨ã€‚

```bash
$ ./queue < input.txt > output.txt
```

# Coding Style

é€™æ˜¯ä¸€å€‹çœ‹ä¼¼å¾®å°å»éå¸¸é‡è¦çš„ç´°ç¯€ï¼Œå°¤å…¶æ˜¯éœ€è¦åˆ¥äººå¹«å¿™ review ç”šè‡³æ˜¯åˆä½œæ™‚éƒ½éœ€è¦äº‹å…ˆè¬›å¥½å…±ç”¨çš„ coding styleï¼Œä¸€ä¾†æ ¼å¼çµ±ä¸€é–±è®€æ™‚ä¸éœ€è¦è½‰æ›ï¼ŒäºŒä¾†å¯ä»¥é¿å…å› ç‚ºå·¥å…·è‡ªå‹•èª¿æ•´é€ æˆä¸å¿…è¦çš„ç¨‹å¼æ”¹å‹•ç´€éŒ„ã€‚

çœ‹åˆ¥äººçš„ç¨‹å¼ç¢¼æ™‚æœ€æ€•é‡åˆ°æ²’æœ‰ç¸®æ’çš„...

é€™è£¡æ¶µè“‹çš„ç¯„åœåŒ…æ‹¬äº†ç¸®æ’ã€ç©ºæ ¼ã€æ‹¬è™Ÿã€å‘½åã€‚

![google-pythonize ... åˆ¥äº‚å­¸ XDD](https://drive.google.com/open?id=1srj3r8VaQ4_csG69Lr3vQD_ENvjEXmJH) [^8]

## Google Coding Style

è‹¥è¦å·æ‡¶ï¼Œå¼·çƒˆå»ºè­°å°±ç›´æ¥ç”¨æœ€å¤šäººä½¿ç”¨çš„å°±å¥½ï¼Œå¾ˆå¤šå·¥å…·éƒ½æœ‰è¾¦æ³•å¹«å¿™é‡æ–°æ’ç‰ˆç¨‹å¼ç¢¼ï¼Œé€™è£¡å±•ç¤ºå¦‚ä½•ç”¨ VSCode ä¾†è¨­å®š Google ä½¿ç”¨çš„ coding styleï¼Œè¦å®šçš„æ ¼å¼ç´°ç¯€å¯åƒè€ƒ [Google C++ Style Guide](https://google.github.io/styleguide/cppguide.html)ã€‚

![google-é–‹å•Ÿè¨­å®š](https://drive.google.com/open?id=1lCoOvNF61c1WaNoZ2MhO9QioANQS3HUS)
![google-æœå°‹ format styleï¼Œå°‡æ¬„ä½æ”¹æˆ Google](https://drive.google.com/open?id=1RCaxBhfaLrVM84FoD3ekeu4AmtBhnxLJ)
![google-ä½¿ç”¨æ ¼å¼åŒ–å¯ä»¥ç”¨å³éµæˆ–æ˜¯ç›´æ¥æŒ‰å°æ‡‰çš„å¿«æ·éµ](https://drive.google.com/open?id=1rALSINyYBW1JuCiWsj1IVSLhiI_-_rXd)

# ç¿’æ…£é¤Šæˆ

> å‚»ç“œéƒ½å¯ä»¥å¯«å‡ºæ©Ÿå™¨èƒ½è®€æ‡‚çš„ä»£ç¢¼ï¼Œä½†åªæœ‰å°ˆæ¥­ç¨‹åºå“¡æ‰èƒ½å¯«å‡ºäººèƒ½è®€æ‡‚çš„ä»£ç¢¼ã€‚  
> --- ç³»çµ±ç¨‹åºå“¡æˆé•·è¨ˆåŠƒ

## Coding Style Again

ç”¨å·¥å…·æ˜¯å¾ˆæ–¹ä¾¿æ²’éŒ¯ï¼Œä¸éç›¡é‡é‚„æ˜¯é¤Šæˆç¿’æ…£è€Œä¸ä¾è³´å·¥å…·ï¼Œé€™è£¡ä»‹ç´¹å¹¾å€‹æ¯”è¼ƒå¸¸è¦‹çš„æ ¼å¼ï¼š

### ç©ºè¡Œ (Blank)

æŠŠæ‰€æœ‰æ“ä½œå¯«åœ¨åŒä¸€å€‹å‡½å¼è£¡é¢é€šå¸¸ä¸å®¹æ˜“è¾¦åˆ°ï¼Œå› æ­¤ä¸å…æœƒæœ‰æŸäº›å€å¡Šåœ¨åšç›¸é—œçš„äº‹ï¼Œåˆç†ä½¿ç”¨ç©ºè¡Œèƒ½å¤ è®“è®€è€…å¾ˆå®¹æ˜“å°±çœ‹å‡ºç¨‹å¼ç¢¼çš„é€™äº›å€å¡Šçš„ç”¨é€”ã€‚

### ç¸®æ’ (Indent)

æˆ‘ä»¥å‰åå¥½ 4 å€‹ç©ºæ ¼ï¼Œä½†æ˜¯æœ€è¿‘æœ‰å¾€å…©å€‹ç©ºæ ¼ç§»å‹•çš„è¶¨å‹¢ï¼Œå¦å¤– Google ä¹Ÿæ˜¯ä»¥ 2 å€‹ç©ºæ ¼ç‚ºä¸»ã€‚ç„¶è€Œ Linux kernel æ˜¯ä½¿ç”¨ tabï¼Œé€™è£¡å…¶å¯¦åªè¦è·Ÿåˆä½œçš„å¤¥ä¼´å€‘è¬›å¥½çµ±ä¸€ä½¿ç”¨ä¸€ç¨®å³å¯ï¼Œå°±ä¸ææœ‰çµ±è¨ˆæŒ‡å‡ºç”¨ space è³ºçš„éŒ¢æ¯”ç”¨ tab çš„äººå¤šäº† [^5]ã€‚

### If Statement

#### åŠ ä¸Šç©ºæ ¼å€‘

```c
if(condition) {   // Bad
if (condition){   // Bad
if(condition){    // Doubly bad
if (condition) {  // Good
```

#### åŠ ä¸Šå¤§æ‹¬è™Ÿå€‘

é€™è£¡æˆ‘æœƒæ¯”è¼ƒåš´æ ¼è¦å®šè‡ªå·±ï¼Œå°±ç®—æ˜¯åªæœ‰ä¸€è¡Œä¹Ÿè¦åŠ ï¼Œé€™æ¨£æ¯”è¼ƒæ–¹ä¾¿æ“´å……ï¼Œä¾‹å¦‚è‡¨æ™‚è¦åŠ ä¸Š `printf` æ™‚å°±ä¸ç”¨å†åŠ ã€‚
```c
if (condition) {
  foo;
} else {
  bar;
}
```

### Loop Statement

#### åŠ ä¸Šç©ºæ ¼å€‘

æ³¨æ„ `;` å‰ä¸è¦å¾Œè¦ã€‚  
é€™è£¡ç”¨ `i++` æˆ– `++i` å…¶å¯¦åŸºæœ¬ä¸Šæ²’æœ‰æ•ˆèƒ½å·®ç•° [^1]ï¼Œç·¨è­¯å™¨æœƒå¹«ä½ æœ€ä½³åŒ–ï¼Œæˆ‘æ›´å–œæ­¡ `i++` å› ç‚ºè¦æ”¹æˆ `i+=2` ä¹‹é¡çš„æ¯”è¼ƒæ–¹ä¾¿ï¼Œå¦å¤–ä¹Ÿæ˜¯æœ‰ `i-=-1` [^2] é€™ç¨®é‚ªæ•™...

```c
for (int i = 0; i < some_number; i++) {
  printf("OuO\n");
}
```

### Pointer è®Šæ•¸å®£å‘Š

`int*x;`ã€`int *x;`ã€`int* x`ã€`int * x` éƒ½æ˜¯å¯ç·¨è­¯çš„å¯«æ³•ï¼Œåœ¨ C ä¸­ `int *x;` æ›´ç‚ºå¸¸ç”¨ã€‚C++ ä¸­åè€Œæ˜¯ `int* x;` [^3]ã€‚

### å‘½å (Naming Convention)

#### æª”æ¡ˆåç¨±ã€è®Šæ•¸ (Variable)ã€å‡½å¼ (Function)

ä½¿ç”¨ [snake_case](https://en.wikipedia.org/wiki/Snake_case) ä¸¦å–æœ‰ä¸Šä¸‹æ–‡é—œä¿‚çš„åå­—ï¼Œä¾‹å¦‚ `flag`ã€`count` å°±æ²’æœ‰ä¸Šä¸‹æ–‡ï¼Œæœƒä¸çŸ¥é“é€™å€‹è®Šæ•¸è¦ç”¨ä¾†å­˜æ”¾ä»€éº¼æ±è¥¿ã€‚  
e.g., `http_server_logs.h`ã€`table_name`  

Google çš„å‡½å¼ä¹Ÿå¯ç”¨ UpperCamelCaseï¼Œä½†æˆ‘å€‹äººæ¯”è¼ƒç¿’æ…£ snake_caseï¼Œå¦å¤–å‡½å¼é ˆä»¥å‹•è©é–‹é ­ä»¥è¡¨æ˜å‹•ä½œã€‚  
e.g., `add_table_entry`

#### Struct, Class

ä½¿ç”¨ [UpperCamelCase](https://en.wikipedia.org/wiki/Camel_case)  
e.g., `UrlTableProperties`, `TableInfo`

#### å¸¸æ•¸ (Constant)

ä½¿ç”¨å…¨å¤§å¯«ä¸¦ä»¥ `_` é€£æ¥ã€‚  
e.g., `MAX_ROW_SIZE`

## åˆå§‹åŒ– (Initialize)

å¯« C èªè¨€æ™‚è¦æ³¨æ„è®Šæ•¸çš„åˆå§‹åŒ–ï¼Œä»¥å…çµæœè·Ÿè‡ªå·±æ‰€æƒ³çš„ä¸ä¸€æ¨£ï¼Œé€™æ˜¯å› ç‚ºåœ¨è¦æ ¼æ›¸ä¸­çš„å®šç¾©ä¸­æåˆ°ï¼Œåªæœ‰å…¨åŸŸè®Šæ•¸æˆ–æ˜¯éœæ…‹ (static) è®Šæ•¸æœƒè¢«åˆå§‹åŒ–ï¼Œå…¶ä»–æœªåˆå§‹åŒ–çš„å‰‡ä¸æœƒæœ‰æ˜ç¢ºçš„åˆå§‹å€¼ã€‚ C99 Â§6.7.8.10 [^4]ã€‚åœ¨é™£åˆ—çš„åˆå§‹åŒ–è‹¥è¦å…¨éƒ¨å®šç¾©ç‚º `\0`ï¼Œæˆ‘å€‘å¯ä»¥ç›´æ¥åœ¨å®£å‘Šä¸­ä½¿ç”¨ `{}` å³å¯ï¼Œå› ç‚ºè¦æ ¼æ›¸ä¸­æœ‰è¦å®šè‹¥åˆå§‹åŒ–çš„å€‹æ•¸ä¸è¶³å‰‡æœƒæ¯”ç…§éœæ…‹è®Šæ•¸ C99 Â§6.7.8.21 [^4]:  

```c
// æ¯å€‹è®Šæ•¸å®£å‘Šæ™‚æ­é…åˆå§‹åŒ–
int n = 0;
// é™£åˆ—åˆå§‹åŒ–ä»¥ä¸‹éƒ½å¯ä»¥
char que[26] = {'\0'};
char que[26] = {0};
char que[26] = {};
```

## è¨»è§£ (Comment)

è«‹ç›¡é‡ä½¿ç”¨è‹±æ–‡ä¾†è¨»è§£ï¼Œå› ç‚ºè‹±æ–‡æ¯”è¼ƒä¸åƒä¸­æ–‡é‚£æ¨£ä¸€è©å¤šç¾©ï¼Œå¯ä»¥è¼ƒæ˜ç¢ºçš„æ•˜è¿°ï¼Œè‹¥åŸ·æ„è¦ç”¨ä¸­æ–‡å°±éœ€è¦æ³¨æ„ç·¨ç¢¼ï¼Œç›®å‰ä¸»æµæ‡‰è©²æ˜¯ä½¿ç”¨ UTF8ã€‚å…§å®¹éƒ¨ä»½å¯ä»¥å¤šè¨˜éŒ„ä¸€é»ä¸Šä¸‹æ–‡è€Œä¸æ˜¯åƒ…åƒ…è©²è¡Œç¨‹å¼ç¢¼åšäº†ä»€éº¼äº‹ï¼Œé€šå¸¸è¨»è§£æœƒæ‹¿ä¾†èªªæ˜æ•´å€‹å‡½å¼ï¼Œæœƒéœ€è¦ä¸€è¡Œä¸€è¡Œè¨»è§£çš„æƒ…æ³æ¯”è¼ƒå°‘ä¸¦æœƒç”¨é«˜å¯è®€æ€§çš„ç¨‹å¼é¦¬ä¾†æ›¿ä»£ã€‚æˆ‘ä¹‹å‰æœ‰æ‰¾åˆ°ä¸€ç¯‡éå¸¸è©³ç›¡çš„æŒ‡å— [^6] å¯ä»¥åƒè€ƒçœ‹çœ‹ (é›–ç„¶æˆ‘ä¹Ÿæ²’æœ‰ä»”ç´°è®€å®Œå°±æ˜¯äº†ï¼ ï¼ 

å¯«æ³•ä¸Šæ³¨æ„ç©ºæ ¼å³å¯ã€‚

```c
// OuO
/* OuO */
```

## å‰¯:ä½œç”¨ (Side Effect)

å‰¯ä½œç”¨ ([Side Effect](https://en.wikibooks.org/wiki/C_Programming/Side_effects_and_sequence_points)) è½èµ·ä¾†å¥½åƒå¾ˆä¸å¦™ï¼Œç°¡å–®ä¾†èªªå°±æ˜¯æœƒåœ¨å‡½å¼å…§éƒ¨ä¿®æ”¹åˆ°åƒæ•¸çš„æƒ…æ³ã€‚å…¶å¯¦é€™åœ¨ä¸€èˆ¬ç¨‹å¼èªè¨€ä¸­é —ç‚ºå¸¸è¦‹ï¼Œæ²’æœ‰é€™é …åŠŸèƒ½çš„è©±ç¨‹å¼æœƒè®Šå¾—ç›¸ç•¶é›£å¯«ï¼Œä¾‹å¦‚ Functional language å¯«èµ·ä¾†å°±é —è€—è²»è…¦åŠ›ã€‚

### åœ¨å‡½å¼å®£å‘Šæ™‚é»å‡ºå‰¯ä½œç”¨

ä½†æ˜¯åœ¨é–‹ç™¼éç¨‹éœ€è¦é©æ™‚éš”é›¢è®ŠåŒ–ï¼ŒC èªè¨€æä¾›äº† `const` ä¿®é£¾å­—ä¾†æ¨™ç¤ºè©²åƒæ•¸åœ¨å‡½å¼ä¸­ä¸æœƒè¢«ä¿®æ”¹ã€‚ä»¥ä¸‹ç¯„ä¾‹ä¸­çš„ `rear` å’Œ `orig`  ä¸æœƒè¢«ä¿®æ”¹åˆ°å…§å®¹ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨ `const` ä¾†æé†’å‡½å¼å‘¼å«è€…è©²åƒæ•¸ä¸æœƒè¢«æ”¹å‹•ï¼Œåä¹‹ `front` å°±æœ‰æ©Ÿæœƒè¢«æ”¹å‹•ã€‚è©³ç´°çš„æ’åˆ—çµ„åˆå¯ä»¥åƒè€ƒ [^9]ã€‚

```c
void deque(char *orig, int *front, int *rear) {
  if (*front == *rear) {
    printf("Empty");
  } else {
    printf("%c\n", orig[*front]);
    *front = *front + 1;
  }
}
```

```c
// rear, orig çš†æ˜¯æŒ‡å‘ä¸€å€‹å”¯è®€åƒæ•¸ (read-only parameter)
// çš„å”¯è®€æŒ‡æ¨™ (read-only location)
// è‹¥å˜—è©¦åœ¨å‡½å¼ä¸­ä¿®æ”¹ `rear` æˆ– `*rear` å°±æœƒå¾—åˆ°ç·¨è­¯éŒ¯èª¤
void deque(
    const char * const orig,
    int *front,
    const int * const rear) {
```

### éœ€è¦ä¿®æ”¹çš„æ‰å‚³å…¥å…¶æŒ‡æ¨™ (Pointer)

é€™è£¡è¦å…ˆå®£å°ä¸€å€‹è§€å¿µå°±æ˜¯ C èªè¨€åªæœ‰ Pass By Valueï¼Œä¹Ÿå°±æ˜¯åªæœƒè¤‡è£½å‚³å…¥è®Šæ•¸çš„æ•¸å€¼ï¼Œå‚³å…¥æŒ‡æ¨™ä¹Ÿæ˜¯ä¸€æ¨£ï¼Œæˆ‘å€‘åªæ˜¯å‚³å…¥äº†æŒ‡æ¨™é€™å€‹æ•¸å€¼ï¼Œè€Œé€éé€™å€‹æŒ‡æ¨™çš„å–å€¼ (dereference) å¯ä»¥æ”¹å‹•å°æ‡‰çš„è¨˜æ†¶é«”ä½ç½® C99 Â§6.5.2.2.4 [^4]ã€‚è€Œå› ç‚º C çš„å‡½å¼å›å‚³å€¼åªé™ä¸€å€‹ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æœƒä½¿ç”¨ä¿®æ”¹åƒæ•¸çš„æ–¹å¼ä¾†å›å‚³æ•¸å€¼ï¼Œè€ŒçœŸæ­£çš„å›å‚³å€¼å°±ç”¨ä¾†è¡¨ç¤ºå‡½å¼æ˜¯å¦æ­£ç¢ºåŸ·è¡Œï¼Œå¦å‰‡å°±å›å‚³å°æ‡‰çš„éŒ¯èª¤ç¢¼ã€‚

ä¸Šé¢é‚£æ¨£æ”¹èµ·ä¾†å¥½åƒå¤ªå¥‡è‘©ï¼Œæ›´å¥½çš„è§£æ±ºæ–¹å¼æ˜¯è¦å…ˆæ€è€ƒï¼ŒæŠŠå°‡è¦åœ¨å‡½å¼å…§éƒ¨æ›´å‹•è®Šæ•¸åœ¨å‚³å…¥å…¶æŒ‡æ¨™ï¼Œå…¶é¤˜çš„åªé ˆæŠŠæ•¸å€¼å‚³é€²å»å³å¯ã€‚ç•¶ç„¶è‹¥æ˜¯å‚³å…¥é™£åˆ—å°±é‚„æ˜¯éœ€è¦æŒ‡æ¨™å°±åƒ `orig`ã€‚

```c
// å› ç‚ºæœ€å¾Œä¸€å€‹åƒæ•¸ä¸æœƒè®Šå‹•è€Œä¸”åªéœ€è¦å…¶æ•¸å€¼
// æ‰€ä»¥ç›´æ¥ä»¥å¸¸æ•¸å‚³å…¥ï¼Œç•¶ç„¶å‡½å¼å…§éƒ¨å°±ä¸éœ€è¦å–å€¼äº†
void deque(
    char const * const orig,
    int *front,
    const int rear_value) {
  if (*front == rear_value) {
    printf("Empty");
  } else {
    printf("%c\n", orig[*front]);
    *front = *front + 1;
  }
}
```

## å¤šæª”æ¡ˆ

### é¿å…é‡è¤‡ include

å°ˆæ¡ˆæ“´å¼µä¸‹ï¼Œå¿…ç„¶æœƒç”¨åˆ°å¤šæª”æ¡ˆï¼Œé€™æ™‚å€™å°±æœƒæ‹†æˆå¾ˆå¤šçš„ `.h`, `.c` æª”ï¼Œ`.h` ç”¨ä¾†ä½œç‚ºç•Œé¢çš„æºé€šï¼Œé€™æ™‚å€™ä¸€å®šè¦ä½¿ç”¨ macro ([Include guard](https://en.wikipedia.org/wiki/Include_guard)) é˜²æ­¢é‡è¤‡ includeã€‚ä»¥ä¸‹ç‚ºæª”åç‚º `file.h` çš„å…§å®¹ç¯„ä¾‹ï¼š`FILE_H`, `_FILE_H`, `__FILE_H__` éƒ½æœ‰äººç”¨ï¼Œä½†ä¸€èˆ¬ä»¥ç¬¬ä¸€ç¨®ç‚ºä¸»å³å¯ã€‚

```c
#ifndef FILE_H
#define FILE_H

/* ... Declarations etc here ... */

#endif /* FILE_H */
```

### ç”¨ `static` ä¿®é£¾å…§éƒ¨å‡½æ•¸

å¦‚æœåœ¨å¤šæª”æ¡ˆä¸‹å‡½æ•¸ä¸¦ä¸æ˜¯è¦é–‹æ”¾çµ¦å…¶ä»–æª”æ¡ˆå‘¼å«æ™‚ï¼Œè«‹åŠ ä¸Š `static` ä¾†ä¿è­‰åªæœ‰ç•¶å‰æª”æ¡ˆå…§éƒ¨å¯ä»¥çœ‹åˆ°é‚£å€‹å‡½æ•¸ã€‚

```c
static void my_local_function() {
  printf("OuO\n");
}
```

## é¿å…ä½¿ç”¨å±éšªçš„å‡½å¼å€‘

C èªè¨€çµ¦äºˆä½¿ç”¨è€…ç›¸ç•¶å¤§çš„å½ˆæ€§ä½†ç”¨èµ·ä¾†éœ€è¦çŸ¥é“è‡ªå·±åœ¨åšä»€éº¼ï¼Œå¦å‰‡æœƒæœ‰è¨±å¤šå®‰å…¨æ€§æ¼æ´ï¼Œæœ‰ä¸€äº›å‡½å¼å¾ˆå®¹æ˜“é€ æˆèª¤ç”¨ï¼Œé€£è³‡æ·±å·¥ç¨‹å¸«ä¹Ÿå¸¸ç”¨éŒ¯ï¼Œå› æ­¤è »å¤šå°ˆæ¡ˆç›´æ¥æŠŠä¸å®‰å…¨çš„å‡½å¼ç¦ç”¨ï¼Œä¾‹å¦‚ Git [^12]ï¼ŒIntel çš„ safestringlib ä¹Ÿæœ‰ä¸€å€‹å®Œæ•´åˆ—è¡¨ [^13]ã€‚ä»¥ä¸‹çµ¦å‡ºä¸€äº›è¼ƒå¸¸è¦‹çš„ã€‚

+ `gets()` [^10] C11 å·²ç¶“ä¸æ”¯æ´ï¼Œè«‹æ”¹ç”¨ `fgets()`
+ `strcpy()` æ²’æœ‰é•·åº¦åµæ¸¬ã€‚
+ `strncpy()` æœ‰é•·åº¦ä½†æ˜¯ä¸æœƒåœ¨çµå°¾è£œä¸Š `\0` [^11]ã€‚
+ `ato*()` æ”¹ç”¨ `strto*()` åˆ©æ–¼éŒ¯èª¤è™•ç† C99 Â§7.20.1 [^4]ã€‚

## å…¶ä»–ç¿’æ…£

+ ç›¡é‡ä¸ä½¿ç”¨å…¨åŸŸè®Šæ•¸


[{{ ä¸‹ä¸€ç¯‡å‚³é€é–€ï¼šProgramming Sense (2) }}]({{< ref "/posts/20191118-programming-sense-2" >}})


[^1]: [Is there a performance difference between i++ and ++i in C?](https://stackoverflow.com/a/24887/6734174)
[^2]: [`i-=-1` is hipster, expressive and symmetric](https://twitter.com/DasSurma/status/1192736235447619584)
[^3]: [Is `int* p;` right or is `int *p;` right?](http://www.stroustrup.com/bs_faq2.html#whitespace)
[^4]: [C99 è¦æ ¼æ›¸ ISO/IEC 9899:TC3](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf)
[^5]: [Developers Who Use Spaces Make More Money Than Those Who Use Tabs](https://stackoverflow.blog/2017/06/15/developers-use-spaces-make-money-use-tabs/)
[^6]: [Writing system software: code comments.](http://antirez.com/news/124)
[^7]: [Tim Pope: when people ask me to recommend a text editor](https://twitter.com/tpope/status/1172743697315835904)
[^8]: [A Python programmer attempting Java](https://www.reddit.com/r/ProgrammerHumor/comments/2wrxyt/a_python_programmer_attempting_java/)
[^9]: [What is the difference between const int*, const int * const, and int const *?](https://stackoverflow.com/a/1143272)
[^10]: [CWE-242: Use of Inherently Dangerous Function](https://cwe.mitre.org/data/definitions/242.html)
[^11]: [How can code that tries to prevent a buffer overflow end up causing one?](https://devblogs.microsoft.com/oldnewthing/?p=36773)
[^12]: [git/banned.h](https://github.com/git/git/blob/master/banned.h)
[^13]: [SDL List of Banned Functions](https://github.com/intel/safestringlib/wiki/SDL-List-of-Banned-Functions)
